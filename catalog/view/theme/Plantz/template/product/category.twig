{{ header }}
<div id="product-special" class="container">
  <div class="row">{{ column_left }}
    {% if column_left and column_right %}
    {% set class = 'col-sm-6' %}
    {% elseif column_left or column_right %}
    {% set class = 'col-sm-9' %}
    {% else %}
    {% set class = 'col-sm-12' %}
    {% endif %}
    <div id="content" class="{{ class }}">
      <ul class="breadcrumb">
    {% for breadcrumb in breadcrumbs %}
    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
    {% endfor %}
  </ul>
      {{ content_top }}
     
	     
      {% if thumb  or  description %} 
      <div class="row category_thumb">
          {% if thumb %}
          <div class="col-sm-3 category_img"><img src="{{ thumb }}" alt="{{ heading_title }}" title="{{ heading_title }}" class="img-thumbnail" /></div>
          {% endif %}
          

          <div class="col-sm-9 category_details" style="display: flex; flex-direction: column; gap: 15px;">
            <h2 class="page-title">{{ heading_title }}</h2>
            {% if description %}
            <div class="category_description">{{ description }}</div>
            {% endif %}
              {% if categories %}
          <div class="category_list">
          <ul>
            {% for category in categories %}
                <div class="category-item" data-debug='{"name":"{{ category.name }}","img":"{{ category.img }}","href":"{{ category.href }}"}'>
                  <div class="category_img">
                    <a href="{{ category.href }}">
                      <img src="{{ category.img }}" alt="{{ category.name }}" title="{{ category.name }}" onerror="console.error('Image failed to load:', this.src); this.style.border='3px solid red';" onload="console.log('Image loaded successfully:', this.src)" />
                    </a>
                  </div>
                  <a href="{{ category.href }}">{{ category.name }}</a>
                </div>
              {% endfor %}
            </ul>
          </div>
          <script>
          console.log('=== Category List Debug ===');
          document.querySelectorAll('.category-item').forEach((item, index) => {
            const debug = JSON.parse(item.dataset.debug);
            console.log(`Category ${index + 1}:`, debug);
            const img = item.querySelector('img');
            console.log(`  - Image element:`, img);
            console.log(`  - Image src:`, img ? img.src : 'NO IMAGE ELEMENT');
            console.log(`  - Image complete:`, img ? img.complete : 'N/A');
            console.log(`  - Image naturalWidth:`, img ? img.naturalWidth : 'N/A');
          });
          console.log('========================');
          </script>
      {% endif %}
          </div>
      </div>
      {% endif %}

      {% if products %}
      <div class="category_filter">
        <div class="filter-right">
          <div class="filter-control">
            <label class="control-label" for="input-sort">{{ text_sort }}</label>
            <select id="input-sort" class="form-control" onchange="location = this.value;">
              {% for sorts in sorts %}
              {% if sorts.value == '%s-%s'|format(sort, order) %}
              <option value="{{ sorts.href }}" selected="selected">{{ sorts.text }}</option>
              {% else %}
              <option value="{{ sorts.href }}">{{ sorts.text }}</option>
              {% endif %}
              {% endfor %}
            </select>
          </div>

          <div class="filter-control">
            <label class="control-label" for="input-limit">{{ text_limit }}</label>
            <select id="input-limit" class="form-control" onchange="location = this.value;">
              {% for limits in limits %}
              {% if limits.value == limit %}
              <option value="{{ limits.href }}" selected="selected">{{ limits.text }}</option>
              {% else %}
              <option value="{{ limits.href }}">{{ limits.text }}</option>
              {% endif %}
              {% endfor %}
            </select>
          </div>
        </div>
      </div>

<div class="box-product">
  {% for product in products %}
    <div class="product-card">
      <div class="product-thumb">
        <div class="image {% if product.qty == 0 %}outstock{% endif %}">
          <a href="{{ product.href }}">
            <img src="{{ product.thumb }}" alt="{{ product.name }}" loading="lazy" width="350" height="350" />
          </a>
          {% if product.special %}
            <span class="special-tag">{{ product.percentsaving }}%</span>
          {% endif %}
          {% if product.qty == 0 %}
            <span class="stock_status">{{ text_outstock }}</span>
          {% endif %}
        </div>

        <div class="caption">
          <span class="product-cat">{{ product.catname }}</span>
          <h4 class="product-card_title"><a href="{{ product.href }}">{{ product.name }}</a></h4>

          {% if product.price %}
          <p class="price">
            {% if not product.special %}
              {{ product.price }}
            {% else %}
              <span class="price-new">{{ product.special }}</span>
              <span class="price-old">{{ product.price }}</span>
            {% endif %}
          </p>
          {% endif %}


          <div class="buttons-product-wrapper">
            <div class="action">
              {% if product.qty > 0 %}
                <button type="button" class="cart_button" class="cart_button" data-product-id="{{ product.product_id }}">{{ button_cart }}</button>
              {% else %}
                <button type="button" class="cart_button out_of_stock">{{ text_outstock }}</button>
              {% endif %}
            </div>
            <button class="custom-wishlist" type="button" title="{{ button_wishlist }}" onclick="wishlist.add('{{ product.product_id }}');"></button>
          </div>
        </div>     
      </div>
    </div>
  {% endfor %}
</div>

      <div class="pagination-wrapper">
        <div class="col-sm-6 text-right page-result">{{ results }}</div>  
      <div class="col-sm-6 text-left page-link">{{ pagination }}</div>
      
     </div>     
      {% else %}
      <p>{{ text_empty }}</p>
      <div class="buttons">
        <div class="pull-right"><a href="{{ continue }}" class="btn btn-primary">{{ button_continue }}</a></div>
      </div>
      {% endif %}
      {{ content_bottom }}</div>
      {{ column_right }}</div>
</div>
</div>
</div>
{{ footer }}
