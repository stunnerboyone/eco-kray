<div class="cart-dropdown">
  <button type="button" data-toggle="dropdown" data-loading-text="{{ text_loading }}" class="cart-button">
    <div class="cart_detail">
      <div class="cart_image"><i class="material-icons-outlined shopping-cart"></i></div>
      <span id="cart-total" class="cart_total">{{ cart_count }}</span>
    </div>
  </button>

  <div id="cart" class="cart-dropdown-menu">
    {% if products or vouchers %}
      <div class="cart-items">
        {% for product in products %}
          <div class="cart-item" style="display: flex; align-items: center; padding: 8px 0; gap: 8px; border-bottom: 1px solid #eee;">
            {% if product.thumb %}
              <div class="cart-thumb" style="flex-shrink: 0;"><a href="{{ product.href }}"><img src="{{ product.thumb }}" alt="{{ product.name }}" style="width: 40px; height: 40px; object-fit: cover;" /></a></div>
            {% endif %}
            <div style="flex: 1; display: flex; justify-content: space-between; align-items: center;">
              <div style="flex: 1;">
                <a href="{{ product.href }}" style="font-size: 13px; line-height: 1.2; display: block; margin-bottom: 2px; text-decoration: none; color: #333;">{{ product.name }}</a>
                {% if product.option %}
                  {% for option in product.option %}
                    <div class="option" style="font-size: 11px; color: #666;">- {{ option.name }}: {{ option.value }}</div>
                  {% endfor %}
                {% endif %}
                {% if product.recurring %}
                  <div class="option" style="font-size: 11px; color: #666;">- {{ text_recurring }} {{ product.recurring }}</div>
                {% endif %}
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <div class="quantity-controls" style="display: flex; align-items: center; gap: 2px;">
                  <button type="button" onclick="cart.update('{{ product.cart_id }}', {{ product.quantity - 1 }});" 
                          style="width: 24px; height: 24px; border: 1px solid #ddd; background: #f8f9fa; border-radius: 4px; font-size: 12px; font-weight: normal; line-height: 1; display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 0;">−</button>
                  <input type="text" value="{{ product.quantity }}" onchange="cart.update('{{ product.cart_id }}', this.value);" 
                         style="width: 35px; height: 24px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 12px; padding: 0;" />
                  <button type="button" onclick="cart.update('{{ product.cart_id }}', {{ product.quantity + 1 }});" 
                          style="width: 24px; height: 24px; border: 1px solid #ddd; background: #f8f9fa; border-radius: 4px; font-size: 12px; font-weight: normal; line-height: 1; display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 0;">+</button>
                </div>
                <button onclick="cart.remove('{{ product.cart_id }}');" class="remove-button" style="background: #d2691e; border: none; color: white; cursor: pointer; padding: 2px 6px; font-size: 12px; border-radius: 3px; line-height: 1;">×</button>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <div class="cart-totals">
        {% for total in totals %}
          {% if total.code == 'total' %}
            <div class="cart-total-row">
              <span>{{ total.title }}:</span>
              <strong>{{ total.text }}</strong>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <div class="cart-buttons">
        <a href="{{ cart }}" class="btn btn-view-cart">{{ text_cart }}</a>
        <a href="{{ checkout }}" class="btn btn-checkout">{{ text_checkout }}</a>
      </div>
    {% else %}
      <p class="cart-empty">{{ text_empty_cart }}</p>
    {% endif %}
  </div>
</div>
